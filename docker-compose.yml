version: '3.4'

services:

  #rabbitmq:
  #  image: rabbitmq:latest
  #  container_name: rabbitmq
  #  volumes:
  #    - rabbitmqdata:/var/lib/rabbitmq
  #  ports:
  #    - "15672:15672"
  #    - "5672:5672"
  #  environment:
  #    - RABBITMQ_DEFAULT_USER=guest
  #    - RABBITMQ_DEFAULT_PASS=guest
      
  productdb:
    image: mongo
  
  basketdb:
    image: redis
  
  discountdb:
    image: postgres
  
  pgadmin:
    image: dpage/pgadmin4

  portainer:
    image: portainer/portainer-ce
  productapi:
    image: productapi
    build:
      context: .
      dockerfile: ProductManagementApi/Dockerfile
  
  basketapi:
    image: basketapi
    build:
      context: .
      dockerfile: BasketAPI/Dockerfile

  discountapi:
    image: ${DOCKER_REGISTRY-}discountapi
    build:
      context: .
      dockerfile: DiscountAPI/Dockerfile

  discount.grpc:
    image: ${DOCKER_REGISTRY-}discountgrpc
    build:
      context: .
      dockerfile: Discount.Grpc/Dockerfile

volumes:
  #rabbitmqdata:
  mongodata:
  portainerdata:
  postgresdata:
  pgadmindata:

